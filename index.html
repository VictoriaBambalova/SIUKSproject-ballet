<!doctype html>
<html lang="bg">
  <head>
    <meta charset="utf-8" />
    <title>Класически Балет – Интерактивен Урок</title>

    <script src="suica.js"></script>
    <script src="tween.umd.js"></script>

    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f9f9f9;
      }
      h1,
      h2,
      h3,
      h4 {
        color: #0077b6;
      }
      h1 {
        border-bottom: 2px solid #00b4d8;
        padding-bottom: 10px;
      }

      .container {
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .suica-wrapper {
        text-align: center;
        margin: 20px 0;
        background: #eee;
        padding: 10px;
        border-radius: 8px;
        display: inline-block;
      }

      /* Стил за бутоните под сцената */
      .controls-bar {
        margin-top: 10px;
        display: flex;
        justify-content: center;
        gap: 5px;
        flex-wrap: wrap;
      }

      button {
        background-color: #0077b6;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.3s;
      }
      button:hover {
        background-color: #0096c7;
      }
      button:active {
        transform: scale(0.98);
      }

      .info-box {
        background-color: #e0f7fa;
        border-left: 5px solid #0077b6;
        padding: 15px;
        margin: 20px 0;
      }

      /* Клас за формули или акценти */
      .highlight {
        font-weight: bold;
        font-style: italic;
        color: #555;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>Основни позиции в класическия балет</h1>
      <h4>Интерактивен урок | Suica Проект | 2026</h4>

      <h2>I. Теория</h2>
      <p>
        Класическият балет е сценично изкуство, което се основава на
        формализирани движения и позиции. Основата на цялата балетна техника
        стъпва върху <span class="highlight">пет основни позиции</span> на
        краката (по-късно Сергей Лифар добавя и шеста).
      </p>
      <p>
        Всички движения започват и завършват в една от тези позиции. Най-важната
        характеристика е <strong>"извъртането" (turnout)</strong> – способността
        на танцьора да завърти краката си навън от тазобедрените стави.
      </p>

      <h2>II. Интерактивен модел</h2>
      <div class="info-box">
        <strong>Задача:</strong> Използвайте бутоните под сцената, за да видите
        как балерината заема различните позиции. Обърнете внимание на
        разположението на стъпалата и колената. Можете да въртите камерата с
        мишката.
      </div>

      <div style="text-align: center">
        <div class="suica-wrapper">
          <!-- ✅ СЦЕНАТА Е ЧАСТ ОТ СТРАНИЦАТА (БЕЗ fullwindow) -->
          <suica id="scene" width="700" height="500" background="whitesmoke">
            <proactive></proactive>
            <orbit></orbit>

            <cone
              id="torsoUpper"
              center="0,15,0"
              size="10,15,10"
              color="#00b4d8"
              spinV="180"
              hidden="false"
            ></cone>

            <cone
              id="torsoLower"
              center="0,0,0"
              size="29,8,29"
              color="#0077b6"
              hidden="false"
            ></cone>

            <sphere
              id="waistRing"
              center="0,7.5,0"
              size="6.5,3,6.5"
              color="#0077b6"
              hidden="false"
            ></sphere>

            <group id="HeadGroup" hidden="false">
              <sphere
                id="head"
                center="0,20,0"
                size="7"
                color="mistyrose"
                hidden="false"
              ></sphere>

              <cylinder
                id="neck"
                center="0,13,0"
                size="2.5,5,2.5"
                color="mistyrose"
                hidden="false"
              ></cylinder>

              <sphere
                id="hair"
                center="0,20.5,-0.3"
                size="7"
                color="saddlebrown"
                hidden="false"
              ></sphere>

              <sphere
                id="bun"
                center="0,23.5,-2.5"
                size="3.7"
                color="saddlebrown"
                hidden="false"
              ></sphere>
            </group>

            <sphere
              id="joint"
              size="3"
              color="mistyrose"
              hidden="true"
            ></sphere>

            <cylinder
              id="bone"
              size="2.5,6,2.5"
              color="mistyrose"
              hidden="true"
            ></cylinder>

            <group id="ArmsGroup" center="0,4,-10" spinV="45" hidden="false">
              <group
                id="ShoulderGroup"
                center="-1.5,8,-11"
                spinH="10"
                spinV="60"
                hidden="false"
              >
                <clone
                  src="joint"
                  id="lShoulder"
                  center="5,14,0"
                  hidden="false"
                ></clone>

                <clone
                  src="bone"
                  id="lUpperArm"
                  center="5,14,0"
                  size="2.5,6,2.5"
                  hidden="false"
                ></clone>

                <group
                  id="ElbowGroup"
                  center="13.5,2,-5"
                  spinH="-90"
                  spinV="25"
                  hidden="false"
                >
                  <clone
                    src="joint"
                    id="lElbow"
                    center="5,20,0"
                    size="2.8"
                    hidden="false"
                  ></clone>

                  <clone
                    src="bone"
                    id="lLowerArm"
                    center="5,20,0"
                    size="2.5,6,2.5"
                    hidden="false"
                  ></clone>

                  <clone
                    src="joint"
                    id="wrist"
                    center="5,26,0"
                    size="3,5"
                    spinV="40"
                    spinH="-90"
                    hidden="false"
                  ></clone>
                </group>
              </group>

              <group
                id="RightShoulderGroup"
                center="1.5,8,-11"
                spinH="-10"
                spinV="60"
                hidden="false"
              >
                <clone
                  src="joint"
                  id="rShoulder"
                  center="-5,14,0"
                  hidden="false"
                ></clone>

                <clone
                  src="bone"
                  id="rUpperArm"
                  center="-5,14,0"
                  size="2.5,6,2.5"
                  hidden="false"
                ></clone>

                <group
                  id="RightElbowGroup"
                  center="-13.5,2,-5"
                  spinH="90"
                  spinV="25"
                  hidden="false"
                >
                  <clone
                    src="joint"
                    id="rElbow"
                    center="-5,20,0"
                    size="2.8"
                    hidden="false"
                  ></clone>

                  <clone
                    src="bone"
                    id="rLowerArm"
                    center="-5,20,0"
                    size="2.5,6,2.5"
                    hidden="false"
                  ></clone>

                  <clone
                    src="joint"
                    id="rWrist"
                    center="-5,26,0"
                    size="3,5"
                    spinV="40"
                    spinH="90"
                    hidden="false"
                  ></clone>
                </group>
              </group>
            </group>

            <group id="LegsGroup" center="0,0,0" hidden="false">
              <group id="LeftHipGroup" center="-2,0,0" hidden="false">
                <clone
                  src="bone"
                  id="lThigh"
                  center="0,-9,0"
                  size="3.5,12,3.5"
                  hidden="false"
                ></clone>

                <group id="LeftKneeGroup" center="0,-9,0" hidden="false">
                  <clone
                    src="joint"
                    id="lKnee"
                    size="3.8"
                    hidden="false"
                  ></clone>

                  <clone
                    src="bone"
                    id="lCalf"
                    center="0,-10,0"
                    size="3,9,3"
                    hidden="false"
                  ></clone>

                  <group id="lShoe" spinH="-90" hidden="false">
                    <sphere
                      id="lFootBase"
                      center="0,-10,0"
                      size="3.5,2,3.5"
                      color="#0077b6"
                      hidden="false"
                    ></sphere>

                    <sphere
                      id="lFootTip"
                      center="0,-10,2"
                      size="3,2,7"
                      color="#0077b6"
                      hidden="false"
                    ></sphere>
                  </group>
                </group>
              </group>

              <group id="RightHipGroup" center="2,0,0" hidden="false">
                <clone
                  src="bone"
                  id="rThigh"
                  center="0,-9,0"
                  size="3.5,12,3.5"
                  hidden="false"
                ></clone>

                <group id="RightKneeGroup" center="0,-9,0" hidden="false">
                  <clone
                    src="joint"
                    id="rKnee"
                    size="3.8"
                    hidden="false"
                  ></clone>

                  <clone
                    src="bone"
                    id="rCalf"
                    center="0,-10,0"
                    size="3,9,3"
                    hidden="false"
                  ></clone>

                  <group id="rShoe" spinH="90" hidden="false">
                    <sphere
                      id="rFootBase"
                      center="0,-10,0"
                      size="3.5,2,3.5"
                      color="#0077b6"
                      hidden="false"
                    ></sphere>

                    <sphere
                      id="rFootTip"
                      center="0,-10,2"
                      size="3,2,7"
                      color="#0077b6"
                      hidden="false"
                    ></sphere>
                  </group>
                </group>
              </group>
            </group>
          </suica>

          <!-- ✅ БУТОНИТЕ СА ПОД СЦЕНАТА (НЕ fixed) -->
          <div class="controls-bar">
            <button onclick="goLegs(1)">1-ва позиция</button>
            <button onclick="goLegs(2)">2-ра позиция</button>
            <button onclick="goLegs(3)">3-та позиция</button>
            <button onclick="goLegs(4)">4-та позиция</button>
            <button onclick="goLegs(5)">5-та позиция</button>
            <button onclick="goLegs(6)">6-та позиция</button>
          </div>
        </div>
      </div>

      <h2>III. Анализ на позициите</h2>
      <p>Всяка позиция има своите особености, които видяхте в симулацията.</p>
    </div>

    <script>
      /* ============================================================
         ЦВЕТОВЕ
         ============================================================ */
      function bluish(obj) {
        obj.color = `hsl(${random(180, 225)}, 70%, 50%)`;
        return obj;
      }

      /* ============================================================
         ПАЧКА (пола) – декоративни цилиндри
         ============================================================ */
      const TUTU_COUNT = 500;

      function addTutuLayer(radius, y, width) {
        for (let i = 0; i < TUTU_COUNT; i++) {
          const a = radians((360 * i) / TUTU_COUNT);

          const c = bluish(
            cylinder(
              [radius * Math.cos(a), y, radius * Math.sin(a)],
              [width, 15],
            ),
          );

          c.spinH = 90 + degrees(-a);
          c.spinV = 90 + 15 * Math.sin(6 * a);
        }
      }

      // Трите слоя на пачката
      addTutuLayer(3, 1, 1);
      addTutuLayer(1.5, 4, 1);
      addTutuLayer(0.01, 7, 1);

      /* ============================================================
         6 ПОЗИ НА КРАКАТА + ПЛАВЕН ПРЕХОД (TWEEN)
         ============================================================ */
      window.addEventListener("load", () => {
        const scene = window.scene;
        if (!scene) {
          console.error("Няма <suica id='scene'>.");
          return;
        }

        if (
          !window.LeftHipGroup ||
          !window.RightHipGroup ||
          !window.LeftKneeGroup ||
          !window.RightKneeGroup
        ) {
          console.error(
            "Липсват групи за краката. Провери id-тата: LeftHipGroup, RightHipGroup, LeftKneeGroup, RightKneeGroup.",
          );
          return;
        }

        const poses = {
          1: {
            name: "I",
            baseX: 1.3,
            dist: 0.0,
            turnout: 35,
            front: 0.0,
            kneeBend: 0,
          },
          2: {
            name: "II",
            baseX: 2.0,
            dist: 3.0,
            turnout: 35,
            front: 0.0,
            kneeBend: 0,
          },
          3: {
            name: "III",
            baseX: 2.0,
            dist: 0.4,
            turnout: 35,
            front: 2.0,
            kneeBend: 4,
          },
          4: {
            name: "IV",
            baseX: 2.0,
            dist: 1.2,
            turnout: 35,
            front: 3.5,
            kneeBend: 6,
          },
          5: {
            name: "V",
            baseX: 1.8,
            dist: 0.0,
            turnout: 45,
            front: 4.0,
            kneeBend: 8,
          },
          6: {
            name: "VI",
            baseX: 2.0,
            dist: 1.0,
            turnout: 0,
            front: 0.0,
            kneeBend: 0,
          },
        };

        const current = { ...poses[1] };
        let tween = null;

        function applyLegPose(p) {
          const a = radians(p.turnout);
          const half = p.dist / 2;

          const baseLX = -p.baseX;
          const baseRX = p.baseX;

          LeftHipGroup.center = [
            baseLX - half,
            LeftHipGroup.center[1],
            p.front * 0.5,
          ];
          RightHipGroup.center = [
            baseRX + half,
            RightHipGroup.center[1],
            -p.front * 0.5,
          ];

          LeftHipGroup.spin = [a, 0, 0];
          RightHipGroup.spin = [-a, 0, 0];

          LeftKneeGroup.spin = [0, 0, radians(p.kneeBend)];
          RightKneeGroup.spin = [0, 0, radians(p.kneeBend)];
        }

        window.goLegs = function (id) {
          const target = poses[id];
          if (!target) return;

          if (tween) tween.stop();

          tween = new TWEEN.Tween(current)
            .to(
              {
                baseX: target.baseX,
                dist: target.dist,
                turnout: target.turnout,
                front: target.front,
                kneeBend: target.kneeBend,
              },
              900,
            )
            .easing(TWEEN.Easing.Quadratic.InOut)
            .onUpdate(() => applyLegPose(current))
            .start();
        };

        scene.ontime = () => {
          TWEEN.update();
        };

        // стартова поза
        applyLegPose(current);
      });
    </script>
  </body>
</html>